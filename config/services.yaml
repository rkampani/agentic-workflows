# Agentic Performance Testing Platform — Service Registry
#
# Endpoint filtering:
#   include_endpoints → ONLY these endpoints are tested
#   exclude_endpoints → these endpoints are SKIPPED
#   Patterns: "GET /api/orders*", "POST *", "*/admin/*"
#
# Test data (like JMeter CSV Data Set Config):
#   test_data_file → JSON file with array of rows
#   Each VU gets a different row (round-robin across 500 users)
#   Row fields replace {placeholders} in paths and provide auth/body data
#
#   Example row: {"user_id": "1", "token": "Bearer ...", "body_analyze": {...}}
#   → GET /api/v1/users/{user_id}/history  becomes  /api/v1/users/1/history
#   → Authorization header gets "Bearer ..."
#   → POST /api/v1/analyze body gets body_analyze value
#
#   Field naming conventions:
#     path params:  user_id, meal_id, order_id  → replaces {user_id} etc.
#     auth token:   token                       → sent as Authorization header
#     request body: body_<endpoint_name>        → used for POST/PUT to that endpoint
#     headers:      header_<name>               → sent as custom header

services:

  recommendation-engine:
    description: "ML-powered product recommendations"
    team: "data"
    framework: "fastapi"
    swagger_path: "/openapi.json"
    environments:
      local: "http://localhost:8000"
      staging: "http://localhost:8000"

  user-service:
    description: "User management, profiles"
    team: "platform"
    framework: "spring-boot"
    swagger_path: "/v3/api-docs"
    environments:
      local: "http://localhost:8083"
      staging: "http://localhost:8083"

  payment-service:
    description: "payment-Service"
    team: "health"
    framework: "spring"
    swagger_path: "/v3/api-docs"
    environments:
      local: "http://localhost:9080/payment-service/v1"
      dev: "http://localhost:9080/payment-service/v1"
      staging: "http://localhost:8000"
    test_data_file: "test-data/payment-service/payment-service.json"
    token_file: "test-data/auth/tokens.json"
    include_endpoints:
      - "GET /order-payment/electronic-check/{entityType}/{entityId}"
    exclude_endpoints:
      - "GET /health"
      - "/metrics*"
    max_concurrent_users: 3
    max_duration_seconds: 30

# Safety settings
defaults:
  max_concurrent_users: 500
  max_duration_seconds: 600
  allowed_environments:
    - local
    - dev
    - staging
